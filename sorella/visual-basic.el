
; Removes little annoyances
(setq visual-basic-capitalize-keywords-p nil)
(setq visual-basic-mode-indent 4)

; Uses parfait to lessen the burden of ugliness in the eyes
(defun parfait-visual-basic ()
  (interactive)
  (make-local-variable 'parfait-stable)
  (setq parfait-symtable '())
  (setq tab-width 80)
  (parfait-add-symbols
   '(("\\<function\\>"        . "ùù∫")
     ("\\<return\\>"          . "<-")
     ("\\>_\\<"               . "-")
     ("<="                    . "‚â§")
     (">="                    . "‚â•")
     ("\\<and\\>"             . "‚àß")
     ("\\<or\\>"              . "‚à®")
     ("<>"                    . "‚â†")
     (" & "                   . " . ")
     ("\\<byval "             . "¬∫")
     ("\\<call "              . "‚Ä∫")
     ("\\<set "               . "*")
     ("\\<case\\>"            . "‚Äî")
     ("\\<elseif\\>"          . "else if")
     ("\\<forall\\>"          . "‚àÄ")
     ("\\<me\\(\\.\\|\\>\\)"  . "@")
     ("\\<not\\>"             . "¬¨")
     ("\\<%?rem\\>"           . "„Äé")
     ("\\<%end rem\\>"        . "„Äè")
     (" then\\>"              . ":")
     ("\\<as[ 	]+"           . ": ")
     ("[ 	 ]+=[ 	]+"       . " = ")
     ("\\<wend\\>"            . "/while")
     ("\\<xor\\>"             . "‚äª")
     ("\\<loop\\>"            . "‚Ü∫")
     ("[ 	]_[ 	]*$"      . "	‚Ü≤")))
  (parfait-mode t))

(add-hook 'vbscript-mode-hook 'parfait-visual-basic)
(add-hook 'vbscript-mode-hook
          '(lambda()
             (local-set-key (kbd "<RET>") 'newline)))
